{% extends "allauth/layouts/base.html" %}
{% load allauth i18n static %}

{% block head_title %}{% trans "Mon profil" %}{% endblock head_title %}

{% block content %}
<section class="section profile">
  <div class="container" data-aos="fade-up" data-aos-delay="100">
    <div class="max-w-6xl mx-auto px-4 py-8 space-y-8">
      {# ——— Messages ——— #}
      {% if messages %}
      <div class="fixed top-6 right-6 z-[9999] pointer-events-none">
        <div class="flex flex-col items-end gap-4 w-[92vw] max-w-xl">

          {% for message in messages %}
          {% with tags=message.tags %}
          <div
            class="relative pointer-events-auto w-full rounded-2xl bg-white shadow-2xl ring-1 ring-black/5 p-5 sm:p-6 pr-12 animate-toast-enter"
            role="{% if 'error' in tags or 'danger' in tags %}alert{% else %}status{% endif %}"
            aria-live="{% if 'error' in tags or 'danger' in tags %}assertive{% else %}polite{% endif %}" data-toast
            data-toast-timeout="6000" {# plus longtemps, plus visible #}>
            {# Barre d’accent à gauche (couleur selon statut) #}
            <span class="absolute inset-y-0 left-0 w-1.5 rounded-l-2xl
        {% if 'success' in tags %} bg-green-500
        {% elif 'error' in tags or 'danger' in tags %} bg-red-500
        {% elif 'warning' in tags %} bg-yellow-500
        {% else %} bg-blue-500 {% endif %}" aria-hidden="true"></span>

            <div class="flex items-start gap-4">
              {# Pastille icône plus grande #}
              <div class="shrink-0 rounded-full p-2
          {% if 'success' in tags %} bg-green-50 text-green-600
          {% elif 'error' in tags or 'danger' in tags %} bg-red-50 text-red-600
          {% elif 'warning' in tags %} bg-yellow-50 text-yellow-700
          {% else %} bg-blue-50 text-blue-600 {% endif %}">
                {% if 'success' in tags %}
                <svg class="h-7 w-7" viewBox="0 0 24 24" fill="none">
                  <circle cx="12" cy="12" r="10" fill="currentColor" class="opacity-10" />
                  <path d="M7 12l3 3 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                {% elif 'error' in tags or 'danger' in tags %}
                <svg class="h-7 w-7" viewBox="0 0 24 24" fill="none">
                  <circle cx="12" cy="12" r="10" fill="currentColor" class="opacity-10" />
                  <path d="M8 8l8 8M16 8l-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                {% elif 'warning' in tags %}
                <svg class="h-7 w-7" viewBox="0 0 24 24" fill="none">
                  <path d="M12 3l9 16H3l9-16z" fill="currentColor" class="opacity-10" />
                  <path d="M12 9v5M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                {% else %}
                <svg class="h-7 w-7" viewBox="0 0 24 24" fill="none">
                  <circle cx="12" cy="12" r="10" fill="currentColor" class="opacity-10" />
                  <path d="M12 8h.01M11 11h2v5h-2z" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                {% endif %}
              </div>

              {# Texte plus grand/gras #}
              <div class="text-[15px] md:text-base leading-6 text-gray-900 font-semibold">
                {{ message }}
              </div>
            </div>

            {# bouton fermer #}
            <button type="button"
              class="absolute top-3 right-3 text-gray-500 hover:text-gray-900 p-1 rounded focus:outline-none"
              data-toast-close aria-label="Fermer la notification">
              &times;
            </button>

            {# barre de progression plus épaisse et visible #}
            <div class="mt-4 h-1.5 rounded-full overflow-hidden bg-gray-100">
              <div class="h-full w-full origin-left animate-toast-progress
          {% if 'success' in tags %} bg-green-500
          {% elif 'error' in tags or 'danger' in tags %} bg-red-500
          {% elif 'warning' in tags %} bg-yellow-500
          {% else %} bg-blue-500 {% endif %}"></div>
            </div>
          </div>
          {% endwith %}
          {% endfor %}

        </div>
      </div>
      {% endif %}

      <div id="public-profile-section" hx-get="{% url 'accounts:profile_public' %}" hx-trigger="load"
        hx-swap="outerHTML" class="border rounded-lg shadow-md bg-white p-6">Chargement du profil public...

      </div>

      <!-- ✅ SECTION PRIVÉE EN DESSOUS -->
      <div id="editable-profile-section" hx-get="{% url 'accounts:profile_info' %}" hx-trigger="load"
        hx-swap="outerHTML" class="border rounded-lg shadow-md bg-white p-6">
        Chargement des infos privées...
      </div>
    </div>





  </div>
  </div>
</section>
{% endblock content %}