{% extends "allauth/layouts/base.html" %}
{% load allauth i18n static %}
{% block head_title %}
{% trans "Sécurité & connexion" %}
{% endblock head_title %}
{% block content %}

<section class="section profile">
    <!-- Page Title -->
    <header class="container section-title" data-aos="fade-up" data-aos-delay="100">
        <div class="row d-flex justify-content-center text-center">
            <div class="col-lg-8">
                <h1>
                    <span>{% trans 'Sécurité & connexion'%}</span>
                </h1>
                <!--<p class="mb-0">{% trans "Please enter your credentials to access your account." %}</p>-->
            </div>
        </div>
  {% include "./nav_profile.html" %}

    </header><!-- End Page Title -->


    <div class="container" data-aos="fade-up" data-aos-delay="100">

        <div class="border p-4 rounded-lg shadow bg-white max-w-4xl mx-auto px-4 py-6 space-y-10">
            
            <div id="email-edit" hx-get="{% url 'accounts:email_display' %}" hx-trigger="load" hx-swap="innerHTML">
            </div>

            <!-- ✅ Changer le mot de passe -->
            <div id="security-password" hx-get="{% url 'accounts:account_change_password' %}" hx-trigger="load"
                hx-swap="innerHTML">
            </div>

            <!-- Bouton qui ouvre le modal -->
            <button type="button"
                    onclick="document.getElementById('deactivate-modal').showModal()"
                    class="btn btn-danger">
                ❌ Supprimer mon compte
            </button>

    </div>
        <!-- Modal -->
        <dialog id="deactivate-modal" class="rounded shadow-lg p-6 w-full max-w-md">
        <form method="post" action="{% url 'accounts:deactivate_account' %}">
            {% csrf_token %}
            <h2 class="text-xl font-bold text-red-600 mb-4">⚠️ Désactiver ton compte</h2>
            <p class="mb-6">Tu ne pourras plus accéder à ton compte sans qu’un admin te réactive.</p>

            <div class="flex justify-between">
                <button type="submit" class="btn btn-success">Confirmer</button>
                <button type="reset" class="btn btn-danger" onclick="document.getElementById('deactivate-modal').close()">Annuler</button>
            </div>
        </form>
        </dialog>

    </div>
    
</section><!-- End Profile Section -->
{% endblock content %}