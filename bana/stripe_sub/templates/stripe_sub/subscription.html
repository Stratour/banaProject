{% extends '/home/bana_community/banaProject/bana/accounts/templates/allauth/layouts/base.html' %}

{% block content %}
<div class="max-w-2xl mx-auto py-10">
    <h2 class="text-2xl font-bold text-center mb-6">Mon abonnement</h2>

    {% if request.user.profile.service == "Parent" %}

    <!-- üîé Description Parent -->
    <div class="bg-green-50 border border-green-100 rounded-xl p-5 mb-8">
        <p class="text-gray-700 leading-relaxed">
            En tant que <span class="font-semibold">Parent</span>, votre objectif principal est de <strong>rechercher de l‚Äôaide pour les trajets de vos enfants</strong>. 
            Vous pouvez ainsi trouver facilement les trajets propos√©s par des Yayas ou d‚Äôautres parents pour vos besoins quotidiens.
        </p>
        <ul class="mt-3 space-y-2 text-gray-700">
            <li>‚úÖ <span class="font-medium">Rechercher un trajet</span> : trouvez les trajets propos√©s par des Yayas ou d‚Äôautres parents pour vos enfants.</li>
            <li>‚úÖ <span class="font-medium">Proposer un trajet</span> : si vous effectuez un trajet, vous pouvez √©galement prendre en charge d‚Äôautres enfants pour aider la communaut√©.</li>
        </ul>
        <p class="mt-3 text-gray-600 italic">Ainsi, vous b√©n√©ficiez √† la fois d‚Äôun soutien pour vos d√©placements et participez √† la solidarit√© entre familles</p>
    </div>
    {% else %}
    
    <!-- üîé Description Yaya -->
    <div class="bg-green-50 border border-green-100 rounded-xl p-5 mb-8">
        <p class="text-gray-700 leading-relaxed">
            Avec <span class="font-semibold">Yaya</span>, vous pouvez proposer diff√©rents types de trajets adapt√©s aux besoins des parents :
        </p>
        <ul class="mt-3 space-y-2 text-gray-700">
            <li>‚úÖ <span class="font-medium">Trajet classique</span> : un trajet d‚Äôun point <strong>A</strong> vers un point <strong>B</strong>, que ce soit pour une seule journ√©e ou de mani√®re r√©guli√®re sur une p√©riode d√©finie.</li>
            <li>‚úÖ <span class="font-medium">Trajet simplifi√©</span> : vous indiquez uniquement un <strong>lieu de d√©part</strong>, sans destination pr√©cise, pour permettre d‚Äôaider n‚Äôimporte quel parent dans la zone.</li>
        </ul>
    </div>
    {% endif %}
    
    {% if active_subscription %}
    <div class="bg-white shadow-lg rounded-2xl p-6 border border-green-100">
        <h4 class="text-xl font-semibold text-gray-800">{{ active_subscription.product_name }}</h4>
        <p class="mt-2 text-gray-600">
            <strong>Prix :</strong> 
            <span class=" font-bold">{{ active_subscription.price }} ‚Ç¨ / an</span>
        </p>
        <p class="text-gray-600">
            <strong>Date de d√©but :</strong> 
            {% if active_subscription.current_period_start %}
                {{ active_subscription.current_period_start|date:"d/m/Y" }}
            {% else %}
                Non d√©finie
            {% endif %}
        </p>
        {% comment "R√©cup√©rer la variable current_period_end" %}
        <p class="text-gray-600">
            <strong>Date de fin :</strong> 
            {% if active_subscription.current_period_end %}
                {{ active_subscription.current_period_end|date:"d/m/Y" }}
            {% else %}
                Non d√©finie
            {% endif %}
        </p>
        {% endcomment %}
        <p class="mt-4">
            <strong>Statut :</strong> 
            {% if active_subscription.is_active %}
                <span class="px-3 py-1 bg-green-100  text-sm font-medium rounded-full">‚úÖ Actif</span>
            {% else %}
                <span class="px-3 py-1 bg-red-100 text-sm font-medium rounded-full">‚ùå Inactif</span>
            {% endif %}
        </p>
    </div>

    {% else %}
    <div class="bg-white shadow-lg rounded-2xl p-6 border border-green-100 text-center">
        <p class="text-gray-600 mb-4">Vous n‚Äôavez pas encore d‚Äôabonnement actif.</p>

        <form method="post" action="{% url 'create_checkout_session' %}">
            {% csrf_token %}
            <input type="hidden" name="price_id" value="{{ price.id }}">
            <button type="submit" 
                class="inline-flex items-center bg-green-500 gap-2 py-2 px-6 my-4 text-white hover:bg-brand-50 hover:text-brand rounded-full shadow transition">
                S‚Äôabonner pour {{ product_price|floatformat:0 }} ‚Ç¨/an
            </button>
        </form>
    </div>
    {% endif %}
</div>
{% endblock %}
