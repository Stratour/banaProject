{% extends 'layouts/base.html' %}

{% block title %}Trajet proposé - BanaCommunity{% endblock %}

{% block content %}

{% include "/home/bana_community/banaProject/bana/accounts/templates/account/profile/nav_profile.html" %}

<div class="bg-gray-100 min-h-screen p-6">
        <div class="container mx-auto">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center"> Trajets proposé</h2>

        <ul class="flex border-b border-gray-300">
          <li class="mr-4">
            <a href="{% url 'proposed_traject' %}"
              class="inline-block px-4 py-2 text-gray-600 hover:text-indigo-600 hover:border-b-2 hover:border-indigo-400 transition">
              Proposer un trajet
            </a>
          </li>
          <li class="mr-4">
            <a href="{% url 'all_proposed_trajects' %}"
              class="inline-block px-4 py-2 text-gray-700 font-medium border-b-2 border-indigo-600">
              Mes propositions de trajets
            </a>
          </li>
          <li>
            <a href="#"
              class="inline-block px-4 py-2 text-gray-600 hover:text-indigo-600 hover:border-b-2 hover:border-indigo-400 transition">
              Mes matchings
            </a>
          </li>
        </ul>

{% if proposed_trajects %}
<ul class="space-y-4">
  {% for proposed in proposed_trajects %}
  <li class="bg-white shadow-md rounded-lg p-4 flex justify-between items-center">
    <div>
      <h3 class="text-xl font-semibold text-gray-700">
        Membre :
        {% if proposed.user.id == request.user.id %}
        <!--  Si c'est l'utilisateur lui-même, rediriger vers son profil -->
        <a href="{% url 'accounts:profile' %}" class="text-blue-500 hover:underline">
          {{ proposed.user.username }}
        </a>
        {% else %}
        <!--  Sinon, aller vers le profil du membre avec avis -->
        <a href="{% url 'profile_user' user_id=proposed.user.id %}" class="text-blue-500 hover:underline">
          {{ proposed.user.username }}
        </a>
        {% endif %}
      </h3>
      <p class="text-gray-600">
        <strong>Adresse de départ:</strong>
        {{ proposed.traject.start_adress }} |
        {{ proposed.traject.start_locality }},
        {{ proposed.traject.start_cp }}

      </p>
      <p class="text-gray-600">
        <strong>Adresse de destination:</strong>
        {{ proposed.traject.end_adress }} |
        {{ proposed.traject.end_locality }},
        {{ proposed.traject.end_cp }}
      </p>
      <p class="text-gray-600"><strong>Date: </strong>{{ proposed.date|date:"l j F Y" }}</p>
      <p class="text-gray-600"><strong>Heure de
          départ:</strong> {{ proposed.departure_time }}</p>
      <p class="text-gray-600"><strong>Moyens de
          transport:</strong> {{ proposed.transport_modes.all|join:", " }}</p>
      <p class="text-gray-600"><strong>Nombre de
          place:</strong> {{ proposed.number_of_places }}</p>
      <p class="text-gray-600"><strong>Langue parlée:</strong>
        {% if proposed.languages.all %}
        {% for language in proposed.languages.all %}
        {{ language.lang_name }}{% if not forloop.last %}, {% endif %}
        {% endfor %}
        {% else %}
        Aucune langue(s) spécifiée(s)
        {% endif %}
      </p>
    </div>

  </li>
  {% endfor %}
</ul>
{% else %}
<p class="text-gray-600">Aucun trajet disponible actuellement</p>
{% endif %}

</div>
{% endblock %}