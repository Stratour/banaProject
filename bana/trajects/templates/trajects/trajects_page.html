{% extends 'layouts/base.html' %}

{% block title %}All Trajects - BanaCommunity{% endblock %}

{% block content %}
<div class="bg-gray-100 min-h-screen p-6">
    <div class="container mx-auto">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Search Trajects</h2>

        <form method="get" action="{% url 'search_trajects' %}" class="space-y-4 mb-6">
            <div>
                <label for="start_locality" class="block text-gray-700">Start City:</label>
                <input type="text" id="start_locality" name="start_locality" placeholder="e.g., Couillet" class="form-input mt-1 block w-full rounded-md border-gray-300 shadow-sm">
            </div>
            <div>
                <label for="end_locality" class="block text-gray-700">End City:</label>
                <input type="text" id="end_locality" name="end_locality" placeholder="e.g., Bruxelles" class="form-input mt-1 block w-full rounded-md border-gray-300 shadow-sm">
            </div>
            <button type="submit" class="py-2 px-4 bg-indigo-600 text-white rounded-md hover:bg-indigo-700">Search</button>
        </form>

        <h2 class="text-2xl font-bold text-gray-800 mb-6">Proposed Trajects</h2>
        {% if proposed_trajects %}
            <ul class="list-disc list-inside space-y-2">
                {% for proposed in proposed_trajects %}
                    <li class="bg-white shadow p-4 rounded">
                        {{ proposed.traject.start_locality }} to {{ proposed.traject.end_locality }}
                        Departure: {{ proposed.departure_time }}, Arrival: {{ proposed.arrival_time }}
                    </li>
                {% endfor %}
            </ul>
            <div class="pagination mt-4">
                <span class="step-links flex justify-center space-x-4">
                    {% if proposed_trajects.has_previous %}
                        <a href="?page1=1" class="text-indigo-600 hover:text-indigo-800">&laquo; first</a>
                        <a href="?page1={{ proposed_trajects.previous_page_number }}" class="text-indigo-600 hover:text-indigo-800">previous</a>
                    {% endif %}
        
                    <span class="current text-gray-700">
                        Page {{ proposed_trajects.number }} of {{ proposed_trajects.paginator.num_pages }}.
                    </span>
        
                    {% if proposed_trajects.has_next %}
                        <a href="?page1={{ proposed_trajects.next_page_number }}" class="text-indigo-600 hover:text-indigo-800">next</a>
                        <a href="?page1={{ proposed_trajects.paginator.num_pages }}" class="text-indigo-600 hover:text-indigo-800">last &raquo;</a>
                    {% endif %}
                </span>
            </div>
        {% else %}
            <p class="text-gray-600">No proposed trajects found.</p>
        {% endif %}

        <h2 class="text-2xl font-bold text-gray-800 mb-6 mt-8">Researched Trajects</h2>
        {% if researched_trajects %}
            <ul class="list-disc list-inside space-y-2">
                {% for researched in researched_trajects %}
                    <li class="bg-white shadow p-4 rounded">
                        {{ researched.traject.start_locality }} to {{ researched.traject.end_locality }}
                        Departure: {{ researched.departure_time }}, Arrival: {{ researched.arrival_time }}
                    </li>
                {% endfor %}
            </ul>
            <div class="pagination mt-4">
                <span class="step-links flex justify-center space-x-4">
                    {% if researched_trajects.has_previous %}
                        <a href="?page2=1" class="text-indigo-600 hover:text-indigo-800">&laquo; first</a>
                        <a href="?page2={{ researched_trajects.previous_page_number }}" class="text-indigo-600 hover:text-indigo-800">previous</a>
                    {% endif %}
        
                    <span class="current text-gray-700">
                        Page {{ researched_trajects.number }} of {{ researched_trajects.paginator.num_pages }}.
                    </span>
        
                    {% if researched_trajects.has_next %}
                        <a href="?page2={{ researched_trajects.next_page_number }}" class="text-indigo-600 hover:text-indigo-800">next</a>
                        <a href="?page2={{ researched_trajects.paginator.num_pages }}" class="text-indigo-600 hover:text-indigo-800">last &raquo;</a>
                    {% endif %}
                </span>
            </div>
        {% else %}
            <p class="text-gray-600">No researched trajects found.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
