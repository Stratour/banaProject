{% extends "allauth/layouts/base.html" %}
{% load static %}

{% block title %}Mes propositions - BanaCommunity{% endblock %}

{% block content %}
<div class="bg-white shadow-lg rounded-xl p-16 space-y-10">

  <!-- Onglets -->
  {% include "./component_traject_tabs.html" %}

  <!-- Liste des trajets propos√©s -->
  {% if proposed_trajects %}
  <ul class="space-y-6">
    {% for proposed in proposed_trajects %}
    <li class="bg-gray-50 p-6 rounded-lg border border-gray-200">
      <h3 class="text-lg font-bold text-brand mb-2">
        üóìÔ∏è {{ proposed.date|date:"l d F Y" }}
      </h3>

      <p class="text-sm text-gray-700 mb-1">
        <strong>D√©part :</strong>
        {{ proposed.traject.start_adress }} √† {{ proposed.departure_time|default:"‚Äî" }}
      </p>

      {% if not proposed.is_simple %}
      <p class="text-sm text-gray-700 mb-1">
        <strong>Arriv√©e :</strong>
        {{ proposed.traject.end_adress }} √† {{ proposed.arrival_time|default:"‚Äî" }}
      </p>
      {% endif %}

      <p class="text-sm text-gray-700 mb-1">
        <strong>Transport :</strong>
        {% for mode in proposed.transport_modes.all %}
          {{ mode.name }}{% if not forloop.last %}, {% endif %}
        {% empty %}Non sp√©cifi√©{% endfor %}
      </p>

      {% if not proposed.is_simple %}
      <p class="text-sm text-gray-700 mb-1">
        <strong>Places disponibles :</strong> {{ proposed.number_of_places|default:"‚Äî" }}
      </p>

      <p class="text-sm text-gray-700 mb-1">
        <strong>Langue(s) parl√©e(s) :</strong>
        {% if proposed.languages.all %}
          {% for language in proposed.languages.all %}
            {{ language.lang_name }}{% if not forloop.last %}, {% endif %}
          {% endfor %}
        {% else %}
          Aucune sp√©cifi√©e
        {% endif %}
      </p>

      <p class="text-sm text-gray-700 mb-1">
        <strong>D√©tails :</strong> {{ proposed.details|default:"‚Äî" }}
      </p>
      {% else %}
      <span class="inline-block bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded">
        Trajet simplifi√©
      </span>
      {% endif %}

      <form method="POST" action="{% url 'delete_proposed_traject' proposed.id %}" onsubmit="return confirm('Supprimer ce trajet ?');">
        {% csrf_token %}
        <button type="submit" class="mt-4 px-3 py-1 bg-red-500 text-white text-sm rounded hover:bg-red-600">
          Supprimer
        </button>
      </form>
    </li>
    {% endfor %}
  </ul>
  {% else %}
    <p class="text-center text-gray-500">Vous n‚Äôavez propos√© aucun trajet pour l‚Äôinstant.</p>
  {% endif %}
</div>
{% endblock %}
